(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11c1be6e"],{2909:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n("6b75");function r(e){if(Array.isArray(e))return Object(a["a"])(e)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");function i(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=n("06c5");n("d9e2");function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e){return r(e)||i(e)||Object(s["a"])(e)||c()}},"2f71":function(e,t,n){},"3ae0":function(e,t,n){"use strict";n("ce31")},4185:function(e,t,n){"use strict";n("2f71")},"5dbd":function(e,t,n){},"7abe":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"home-page body"},[n("van-tabs",{attrs:{animated:""},model:{value:e.activeIndex,callback:function(t){e.activeIndex=t},expression:"activeIndex"}},e._l(e.channelList,(function(e){return n("van-tab",{key:e.id,attrs:{title:e.name}},[n("article-list",{attrs:{cid:e.id}})],1)})),1),n("div",{staticClass:"btn-wrapper"},[n("geek-icon",{attrs:{name:"search"}}),n("geek-icon",{attrs:{name:"channel"},nativeOn:{click:function(t){e.isShow=!0}}})],1),n("article-channel",{attrs:{myChannels:e.channelList,activeIndex:e.activeIndex},on:{"update:activeIndex":function(t){e.activeIndex=t},"update:active-index":function(t){e.activeIndex=t}},model:{value:e.isShow,callback:function(t){e.isShow=t},expression:"isShow"}})],1)},r=[],i=n("1da1"),s=(n("96cf"),n("3835")),c=(n("b0c0"),n("e9c4"),n("d3b7"),n("4de4"),n("b775")),o=n("4360");function l(){return Object(c["a"])({url:"channels"})}function u(){return d.apply(this,arguments)}function d(){return d=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,i,l,u,d,f,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=o["a"].state.user.token,t){e.next=17;break}if(n=window.localStorage.getItem("mychannels"),!n){e.next=7;break}return e.abrupt("return",JSON.parse(n||"[]"));case 7:return e.next=9,Object(c["a"])({url:"user/channels"});case 9:if(a=e.sent,r=Object(s["a"])(a,2),i=r[0],l=r[1],!i){e.next=15;break}return e.abrupt("return",this.$toast.fail(i));case 15:return window.localStorage.setItem("mychannels",JSON.stringify(l.data.data.channels)),e.abrupt("return",l.data.data.channels);case 17:return e.next=19,Object(c["a"])({url:"user/channels"});case 19:if(u=e.sent,d=Object(s["a"])(u,2),f=d[0],h=d[1],!f){e.next=25;break}return e.abrupt("return",this.$toast.fail(f));case 25:return e.abrupt("return",h.data.data.channels);case 26:case"end":return e.stop()}}),e,this)}))),d.apply(this,arguments)}function f(e){var t=o["a"].state.user.token;if(t)return Object(c["a"])({url:"user/channels",method:"PUT",data:{channels:e}});var n=JSON.parse(window.localStorage.getItem("mychannels")),a=e[e.length-1],r=a.id,i=a.name;return n.push({id:r,name:i}),window.localStorage.setItem("mychannels",JSON.stringify(n)),Promise.resolve("ok")}function h(e){var t=o["a"].state.user.token;if(t)return Object(c["a"])({url:"user/channels/"+e,method:"DELETE"});var n=JSON.parse(window.localStorage.getItem("mychannels")||"[]");n=n.filter((function(t){return t.id!==e})),window.localStorage.setItem("mychannels",JSON.stringify(n))}function m(e,t){return Object(c["a"])({url:"articles",params:{channel_id:e,timestamp:t}})}var p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"list",staticClass:"article-list",on:{scroll:e.rememberScroll}},[n("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.isRefreshing,callback:function(t){e.isRefreshing=t},expression:"isRefreshing"}},[n("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.articleList,(function(e){return n("article-item",{key:e.art_id,attrs:{article:e}})})),1)],1)],1)},v=[],b=n("2909"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"article-item van-hairline--bottom",on:{click:function(t){return e.$router.push("/article/"+e.article.art_id)}}},[n("p",{staticClass:"title van-multi-ellipsis--l2",class:{w66:e.article&&e.article.cover&&e.article.cover.images&&1===e.article.cover.images.length}},[e._v(e._s(e.article.title))]),e._l(e.article.cover.images,(function(e,t){return n("img",{key:t,staticClass:"img",attrs:{src:e,alt:""}})})),n("div",{staticClass:"info"},[n("span",[e._v(e._s(e.article.aut_name))]),n("span",[e._v(e._s(e.article.comm_count)+"评论")]),n("span",[e._v(e._s(e._f("relativeTime")(e.article.pubdate)))]),n("geek-icon",{attrs:{name:"esay-close"}})],1)],2)},w=[],x={props:["article"]},y=x,k=(n("b893"),n("2877")),_=Object(k["a"])(y,g,w,!1,null,"aeaa0fc0",null),O=_.exports,C={props:["cid"],components:{articleItem:O},activated:function(){this.$refs.list.scrollTop=this.scrollTop},methods:{rememberScroll:function(){this.scrollTop=this.$refs.list.scrollTop},onRefresh:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isRefreshing=!0,t.next=3,m(e.cid,+new Date);case 3:if(n=t.sent,a=Object(s["a"])(n,2),r=a[0],i=a[1],!r){t.next=9;break}return t.abrupt("return",e.$toast.fail(r));case 9:e.articleList=i.data.data.results,e.isRefreshing=!1;case 11:case"end":return t.stop()}}),t)})))()},onLoad:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,m(e.cid,e.timeStamp);case 3:if(a=t.sent,r=Object(s["a"])(a,2),i=r[0],c=r[1],!i){t.next=9;break}return t.abrupt("return",e.$toast.fail(i));case 9:(n=e.articleList).push.apply(n,Object(b["a"])(c.data.data.results)),c.data.data.pre_timestamp?e.timeStamp=c.data.data.pre_timestamp:e.finished=!0,e.loading=!1;case 12:case"end":return t.stop()}}),t)})))()}},data:function(){return{isRefreshing:!1,loading:!1,finished:!1,articleList:[],timeStamp:+new Date,scrollTop:0}},created:function(){}},S=C,j=(n("3ae0"),Object(k["a"])(S,p,v,!1,null,"885ce74a",null)),I=j.exports,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("van-popup",{attrs:{value:e.value,closeable:"",position:"left"},on:{"click-close-icon":function(t){e.$emit("input",!1),e.isEdit=!1}}},[n("div",{staticClass:"article-channel"},[n("div",{staticClass:"head"},[n("h3",[e._v("我的频道"),n("small",[e._v("点击进入频道")])]),n("a",{staticClass:"edit",class:{active:e.isEdit},attrs:{href:"javascript:;"},on:{click:function(t){e.isEdit=!e.isEdit}}},[e._v(e._s(e.isEdit?"完成":"编辑"))])]),n("div",{staticClass:"body"},e._l(e.myChannels,(function(t,a){return n("a",{key:t.id,class:{active:e.activeIndex===a},attrs:{href:"javascript:;"},on:{click:function(t){return e.enterChannel(a)}}},[e._v(e._s(t.name)+" "),n("geek-icon",{directives:[{name:"show",rawName:"v-show",value:e.isEdit&&e.activeIndex!==a&&0!==a,expression:"isEdit && activeIndex!==index && index!==0"}],attrs:{name:"tag-close"},nativeOn:{click:function(n){return n.stopPropagation(),e.deleteChannel(t.id,a)}}})],1)})),0),n("div",{staticClass:"head",staticStyle:{"margin-top":"12px"}},[n("h3",[e._v("频道推荐")])]),n("div",{staticClass:"body"},e._l(e.optionChannels,(function(t){return n("a",{key:t.id,attrs:{href:"javascript:;"},on:{click:function(n){return e.addChannel(t)}}},[e._v(e._s(t.name))])})),0)])])},E=[],$=(n("a434"),n("159b"),n("7db0"),{props:["value","myChannels","activeIndex"],methods:{deleteChannel:function(e,t){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,h(e);case 2:n.myChannels.splice(t,1);case 3:case"end":return a.stop()}}),a)})))()},addChannel:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=JSON.parse(JSON.stringify(t.myChannels)),a.push({id:e.id,name:e.name}),a.forEach((function(e,t){e.seq=t+1})),console.log(a),n.next=6,f(a);case 6:t.myChannels.push({id:e.id,name:e.name});case 7:case"end":return n.stop()}}),n)})))()},enterChannel:function(e){this.$emit("input",!1),this.$emit("update:activeIndex",e)}},data:function(){return{allChannels:[],isEdit:!1}},created:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,a,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,l();case 2:if(n=t.sent,a=Object(s["a"])(n,2),r=a[0],i=a[1],!r){t.next=8;break}return t.abrupt("return",e.$toast.fail(r));case 8:e.allChannels=i.data.data.channels;case 9:case"end":return t.stop()}}),t)})))()},computed:{optionChannels:function(){var e=this;return this.allChannels.filter((function(t){return!e.myChannels.find((function(e){return e.id===t.id}))}))}}}),J=$,L=(n("4185"),Object(k["a"])(J,R,E,!1,null,"a9d08826",null)),N=L.exports,T={name:"Home",data:function(){return{activeIndex:0,channelList:[],isShow:!1}},components:{articleList:I,articleChannel:N},methods:{getMyChannels:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,u();case 2:n=t.sent,e.channelList=n;case 4:case"end":return t.stop()}}),t)})))()}},created:function(){this.getMyChannels()}},A=T,D=(n("835d"),Object(k["a"])(A,a,r,!1,null,"701f8d4b",null));t["default"]=D.exports},"7db0":function(e,t,n){"use strict";var a=n("23e7"),r=n("b727").find,i=n("44d2"),s="find",c=!0;s in[]&&Array(1)[s]((function(){c=!1})),a({target:"Array",proto:!0,forced:c},{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),i(s)},8121:function(e,t,n){},"835d":function(e,t,n){"use strict";n("8121")},a434:function(e,t,n){"use strict";var a=n("23e7"),r=n("da84"),i=n("23cb"),s=n("5926"),c=n("07fa"),o=n("7b0b"),l=n("65f0"),u=n("8418"),d=n("1dde"),f=d("splice"),h=r.TypeError,m=Math.max,p=Math.min,v=9007199254740991,b="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!f},{splice:function(e,t){var n,a,r,d,f,g,w=o(this),x=c(w),y=i(e,x),k=arguments.length;if(0===k?n=a=0:1===k?(n=0,a=x-y):(n=k-2,a=p(m(s(t),0),x-y)),x+n-a>v)throw h(b);for(r=l(w,a),d=0;d<a;d++)f=y+d,f in w&&u(r,d,w[f]);if(r.length=a,n<a){for(d=y;d<x-a;d++)f=d+a,g=d+n,f in w?w[g]=w[f]:delete w[g];for(d=x;d>x-a+n;d--)delete w[d-1]}else if(n>a)for(d=x-a;d>y;d--)f=d+a-1,g=d+n-1,f in w?w[g]=w[f]:delete w[g];for(d=0;d<n;d++)w[d+y]=arguments[d+2];return w.length=x-a+n,r}})},b893:function(e,t,n){"use strict";n("5dbd")},ce31:function(e,t,n){},e9c4:function(e,t,n){var a=n("23e7"),r=n("da84"),i=n("d066"),s=n("2ba4"),c=n("e330"),o=n("d039"),l=r.Array,u=i("JSON","stringify"),d=c(/./.exec),f=c("".charAt),h=c("".charCodeAt),m=c("".replace),p=c(1..toString),v=/[\uD800-\uDFFF]/g,b=/^[\uD800-\uDBFF]$/,g=/^[\uDC00-\uDFFF]$/,w=function(e,t,n){var a=f(n,t-1),r=f(n,t+1);return d(b,e)&&!d(g,r)||d(g,e)&&!d(b,a)?"\\u"+p(h(e,0),16):e},x=o((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&a({target:"JSON",stat:!0,forced:x},{stringify:function(e,t,n){for(var a=0,r=arguments.length,i=l(r);a<r;a++)i[a]=arguments[a];var c=s(u,null,i);return"string"==typeof c?m(c,v,w):c}})}}]);
//# sourceMappingURL=chunk-11c1be6e.803dacaa.js.map